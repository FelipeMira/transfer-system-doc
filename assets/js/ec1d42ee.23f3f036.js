"use strict";(self.webpackChunktransfer_doc=self.webpackChunktransfer_doc||[]).push([[444],{50822:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>d,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>c,toc:()=>t});var s=n(74848),i=n(28453);const r={},o="API de Transfer\xeancia",c={id:"documentacao/transfer-system-doc",title:"API de Transfer\xeancia",description:"Descri\xe7\xe3o",source:"@site/docs/documentacao/transfer-system-doc.md",sourceDirName:"documentacao",slug:"/documentacao/transfer-system-doc",permalink:"/transfer-system-doc/docs/documentacao/transfer-system-doc",draft:!1,unlisted:!1,editUrl:"https://github.com/FelipeMira/transfer-system-doc/tree/main/packages/create-docusaurus/templates/shared/docs/documentacao/transfer-system-doc.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Introdu\xe7\xe3o ao Tutorial",permalink:"/transfer-system-doc/docs/intro"}},d={},t=[{value:"Descri\xe7\xe3o",id:"descri\xe7\xe3o",level:2},{value:"Pr\xe9 Requisitos",id:"pr\xe9-requisitos",level:2},{value:"Como foi constru\xeddo?",id:"como-foi-constru\xeddo",level:2},{value:"Como executar?",id:"como-executar",level:2},{value:"Preparando o ambiente",id:"preparando-o-ambiente",level:4},{value:"Executando a aplica\xe7\xe3o API",id:"executando-a-aplica\xe7\xe3o-api",level:4},{value:"Como acessar e testar a aplica\xe7\xe3o?",id:"como-acessar-e-testar-a-aplica\xe7\xe3o",level:2},{value:"Acessando a aplica\xe7\xe3o",id:"acessando-a-aplica\xe7\xe3o",level:4},{value:"Testando recuperar conta com nome batendo na api de cadastro",id:"testando-recuperar-conta-com-nome-batendo-na-api-de-cadastro",level:5},{value:"Realizando uma transfer\xeancia",id:"realizando-uma-transfer\xeancia",level:5},{value:"Validando a fila do RabbitMQ",id:"validando-a-fila-do-rabbitmq",level:4}];function l(e){const a={code:"code",h1:"h1",h2:"h2",h4:"h4",h5:"h5",hr:"hr",img:"img",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.h1,{id:"api-de-transfer\xeancia",children:"API de Transfer\xeancia"}),"\n",(0,s.jsx)(a.h2,{id:"descri\xe7\xe3o",children:"Descri\xe7\xe3o"}),"\n",(0,s.jsx)(a.p,{children:"API de consulta e transfer\xeancia entre contas com os seguintes requisitos:"}),"\n",(0,s.jsxs)(a.ol,{children:["\n",(0,s.jsx)(a.li,{children:"Buscar o nome do Cliente na API de Cadastro (Mock)"}),"\n",(0,s.jsx)(a.li,{children:"Validar se a conta est\xe1 ativa;"}),"\n",(0,s.jsx)(a.li,{children:"Validar se o Cliente tem o limite dispon\xedvel na conta corrente;"}),"\n",(0,s.jsx)(a.li,{children:"Validar se a transfer\xeancia est\xe1 excedendo o limite di\xe1rio de 1.000 reais;"}),"\n",(0,s.jsx)(a.li,{children:"Ap\xf3s a transfer\xeancia \xe9 necess\xe1rio informar o BACEN em uma API (Mock) que pode retornar 429 com seu controle de rate limit;"}),"\n",(0,s.jsx)(a.li,{children:"Impedir que falas moment\xe2neas das depend\xeancias da aplica\xe7\xe3o impactem o cliente;"}),"\n",(0,s.jsx)(a.li,{children:"Ser desenvolvida em Java/Spring Boot;"}),"\n",(0,s.jsx)(a.li,{children:"Apresentar testes unit\xe1rios e automatizados."}),"\n",(0,s.jsx)(a.li,{children:"Explorar Design patterns;"}),"\n",(0,s.jsx)(a.li,{children:"Implementar padr\xf5es de resili\xeancia na aplica\xe7\xe3o."}),"\n"]}),"\n",(0,s.jsx)(a.hr,{}),"\n",(0,s.jsx)(a.h2,{id:"pr\xe9-requisitos",children:"Pr\xe9 Requisitos"}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsx)(a.li,{children:"Ter a Openjdk ou JDK 17 devidamente configurada na m\xe1quina"}),"\n",(0,s.jsx)(a.li,{children:"Ter o Gradle devidamente configurado na m\xe1quina"}),"\n",(0,s.jsx)(a.li,{children:"Possuir o docker configurado"}),"\n"]}),"\n",(0,s.jsx)(a.hr,{}),"\n",(0,s.jsx)(a.h2,{id:"como-foi-constru\xeddo",children:"Como foi constru\xeddo?"}),"\n",(0,s.jsx)(a.p,{children:"Utilizando uma abordagem hexagonal representada pelas imagens a seguir:"}),"\n",(0,s.jsx)(a.p,{children:(0,s.jsx)(a.img,{alt:"Arquitetura",src:n(28994).A+"",title:"Arquitetura",width:"1270",height:"721"})}),"\n",(0,s.jsx)(a.p,{children:(0,s.jsx)(a.img,{alt:"Arquitetura",src:n(39084).A+"",title:"Arquitetura",width:"231",height:"259"})}),"\n",(0,s.jsx)(a.hr,{}),"\n",(0,s.jsx)(a.h2,{id:"como-executar",children:"Como executar?"}),"\n",(0,s.jsx)(a.h4,{id:"preparando-o-ambiente",children:"Preparando o ambiente"}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsx)(a.li,{children:"Inicie seu docker:"}),"\n"]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-shell",children:'"C:\\PROGRA~1\\Docker\\Docker\\Docker Desktop.exe"\n'})}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsx)(a.li,{children:"Execute o comando:"}),"\n"]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-shell",children:"cd ./infra/docker-transfer/ && docker-compose up\n"})}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsx)(a.li,{children:"Se tudo ocorreu bem seu ambiente est\xe1 configurado"}),"\n"]}),"\n",(0,s.jsx)(a.h4,{id:"executando-a-aplica\xe7\xe3o-api",children:"Executando a aplica\xe7\xe3o API"}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsx)(a.li,{children:"V\xe1 para a pasta raiz do projeto"}),"\n",(0,s.jsxs)(a.li,{children:["Execute o comando: ",(0,s.jsx)(a.code,{children:"gradle :initializers:api:run --args='--spring.profiles.active=hom'"})]}),"\n",(0,s.jsx)(a.li,{children:"!ATEN\xc7\xc3O, n\xe3o foram feitos testes no profile de prod, MAS O PROFILE DE HOMOLOGA\xc7\xc3O PREENCHER\xc1 OS DADOS NO BANCO DE DADOS QUE SUBIMOS NA INFRA COM O DOCKER!!!"}),"\n"]}),"\n",(0,s.jsx)(a.hr,{}),"\n",(0,s.jsx)(a.h2,{id:"como-acessar-e-testar-a-aplica\xe7\xe3o",children:"Como acessar e testar a aplica\xe7\xe3o?"}),"\n",(0,s.jsx)(a.h4,{id:"acessando-a-aplica\xe7\xe3o",children:"Acessando a aplica\xe7\xe3o"}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsx)(a.li,{children:"Abra seu navegador favorito"}),"\n",(0,s.jsxs)(a.li,{children:["V\xe1 para o endere\xe7o: ",(0,s.jsx)(a.code,{children:"http://localhost:8080/swagger-ui.html"})]}),"\n",(0,s.jsxs)(a.li,{children:["Temos duas contas de Teste com ids:","\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsx)(a.li,{children:"1"}),"\n",(0,s.jsx)(a.li,{children:"2"}),"\n",(0,s.jsx)(a.li,{children:"3"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(a.h5,{id:"testando-recuperar-conta-com-nome-batendo-na-api-de-cadastro",children:"Testando recuperar conta com nome batendo na api de cadastro"}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsx)(a.li,{children:"Acesse no swagger a \xe1rea de Recuperar Contas"}),"\n",(0,s.jsx)(a.li,{children:"Expanda o menu e clique em Try it out"}),"\n",(0,s.jsxs)(a.li,{children:["Digite o id com o npumero ",(0,s.jsx)(a.code,{children:"1"})," mencionados acima"]}),"\n",(0,s.jsxs)(a.li,{children:["Clique em ",(0,s.jsx)(a.code,{children:"execute"})]}),"\n",(0,s.jsxs)(a.li,{children:["Se voc\xea for no docker e recuperar os logs de cadastro ver\xe1 que foi consultado:","\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsx)(a.li,{children:(0,s.jsx)(a.code,{children:"API MOCK para correntista encontrou o cliente de id: 1"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(a.li,{children:"Se voc\xea pesquisar novamente a API de Contas buscar\xe1 o resultado no Redis"}),"\n",(0,s.jsxs)(a.li,{children:["Pesquise o outro id com o n\xfamero ",(0,s.jsx)(a.code,{children:"2"})]}),"\n",(0,s.jsx)(a.li,{children:"Agora podemos derrubar no docker o container de cadastro"}),"\n",(0,s.jsx)(a.li,{children:"Ao pesquisar vemos que n\xe3o tivemos erro ao recuperar o nome do cadastro"}),"\n",(0,s.jsx)(a.li,{children:"POR FIM RODE NOVAMENTE NO DOCKER A API DE CADASTRO"}),"\n",(0,s.jsx)(a.li,{children:"Se recuperarmos a conta 3 veremos que ela est\xe1 inativa"}),"\n"]}),"\n",(0,s.jsx)(a.h5,{id:"realizando-uma-transfer\xeancia",children:"Realizando uma transfer\xeancia"}),"\n",(0,s.jsx)(a.p,{children:"Acesse no swagger a \xe1rea de Realizar Transferencias"}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsx)(a.li,{children:"Expanda o menu e clique em Try it out"}),"\n",(0,s.jsxs)(a.li,{children:["Utilize o id ",(0,s.jsx)(a.code,{children:"2"})," para conta de d\xe9bito e o id ",(0,s.jsx)(a.code,{children:"1"})," para conta de cr\xe9dito"]}),"\n",(0,s.jsx)(a.li,{children:"Troque o valor da transfer\xeancia por 300:"}),"\n"]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-json",children:'{\n\t"valorTransferencia": 300\n}\n'})}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsxs)(a.li,{children:["Clique em ",(0,s.jsx)(a.code,{children:"execute"})]}),"\n",(0,s.jsx)(a.li,{children:"Voc\xea receber\xe1 o retorno:"}),"\n"]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-json",children:'{\n  "timestamp": "2024-01-xxT22:46:59.374Z",\n  "exception": "NegocioException",\n  "messages": [\n    "Saldo insuficiente."\n  ],\n  "path": "/transferencias/2/contas/1"\n}\n\n'})}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsxs)(a.li,{children:["Altere os ids e transfira os 300, voc\xea receber\xe1 a seguinte mensagem:\n",(0,s.jsx)(a.code,{children:"Transferencia realizada com sucesso"})]}),"\n",(0,s.jsx)(a.li,{children:"Se voc\xea transferir mais 701 receber\xe1 a seguinte mensagem:"}),"\n"]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-json",children:'{\n  "timestamp": "2024-01-12T22:50:33.385Z",\n  "exception": "NegocioException",\n  "messages": [\n    "Transacao acima do limite diario restante: R$700.00 ."\n  ],\n  "path": "/transferencias/1/contas/2"\n}\n'})}),"\n",(0,s.jsx)(a.h4,{id:"validando-a-fila-do-rabbitmq",children:"Validando a fila do RabbitMQ"}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsxs)(a.li,{children:["Abra uma nova aba no seu navegador e acesse: ",(0,s.jsx)(a.code,{children:"http://localhost:15672/"})]}),"\n",(0,s.jsxs)(a.li,{children:["Utilize o usu\xe1rio e senha padr\xe3o com o valor ",(0,s.jsx)(a.code,{children:"guest"})," para ambos os campos"]}),"\n",(0,s.jsxs)(a.li,{children:["Acesse o site e v\xe1 na aba ",(0,s.jsx)(a.code,{children:"Queues and Streams"})]}),"\n",(0,s.jsx)(a.li,{children:"Derrube a api do bacen no docker."}),"\n",(0,s.jsx)(a.li,{children:"Fa\xe7a uma nova transfer\xeancia v\xe1lida como mostrado no passo a passo anterior"}),"\n",(0,s.jsx)(a.li,{children:"Voc\xea ver\xe1 no swagger a mensagem de sucesso e na fila ver\xe1 que teve um aumento de mensagens armazenadas."}),"\n",(0,s.jsxs)(a.li,{children:["Clique em ",(0,s.jsx)(a.code,{children:"bacen-queue"})," na tabela e recupere uma mensagem em ",(0,s.jsx)(a.code,{children:"Get messages"}),", voc\xea ver\xe1:"]}),"\n"]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-text",children:'The server reported 0 messages remaining.\n\nExchange\t(AMQP default)\nRouting Key\tbacen-queue\nRedelivered\t\u25cb\nProperties\t\npriority:\t0\ndelivery_mode:\t2\nheaders:\t\ncontent_encoding:\tUTF-8\ncontent_type:\ttext/plain\nPayload\n39 bytes\nEncoding: string\n{"idDebito":1,"idCredito":2,"valor":70}\n'})}),"\n",(0,s.jsx)(a.hr,{}),"\n",(0,s.jsxs)(a.ol,{className:"contains-task-list",children:["\n",(0,s.jsxs)(a.li,{className:"task-list-item",children:[(0,s.jsx)(a.input,{type:"checkbox",checked:!0,disabled:!0})," ","Buscar o nome do Cliente na API de Cadastro (Mock)"]}),"\n",(0,s.jsxs)(a.li,{className:"task-list-item",children:[(0,s.jsx)(a.input,{type:"checkbox",checked:!0,disabled:!0})," ","Validar se a conta est\xe1 ativa;"]}),"\n",(0,s.jsxs)(a.li,{className:"task-list-item",children:[(0,s.jsx)(a.input,{type:"checkbox",checked:!0,disabled:!0})," ","Validar se o Cliente tem o limite dispon\xedvel na conta corrente;"]}),"\n",(0,s.jsxs)(a.li,{className:"task-list-item",children:[(0,s.jsx)(a.input,{type:"checkbox",checked:!0,disabled:!0})," ","Validar se a transfer\xeancia est\xe1 excedendo o limite di\xe1rio de 1.000 reais;"]}),"\n",(0,s.jsxs)(a.li,{className:"task-list-item",children:[(0,s.jsx)(a.input,{type:"checkbox",checked:!0,disabled:!0})," ","Ap\xf3s a transfer\xeancia \xe9 necess\xe1rio informar o BACEN em uma API (Mock) que pode retornar 429 com seu controle de rate limit;"]}),"\n",(0,s.jsxs)(a.li,{className:"task-list-item",children:[(0,s.jsx)(a.input,{type:"checkbox",checked:!0,disabled:!0})," ","Impedir que falas moment\xe2neas das depend\xeancias da aplica\xe7\xe3o impactem o cliente;"]}),"\n",(0,s.jsxs)(a.li,{className:"task-list-item",children:[(0,s.jsx)(a.input,{type:"checkbox",checked:!0,disabled:!0})," "," Ser desenvolvida em Java/Spring Boot;"]}),"\n",(0,s.jsxs)(a.li,{className:"task-list-item",children:[(0,s.jsx)(a.input,{type:"checkbox",checked:!0,disabled:!0})," ","Apresentar testes unit\xe1rios e automatizados.","\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsx)(a.li,{children:"Testes unit\xe1rios na camada de sistema, servi\xe7os e adaptadores"}),"\n",(0,s.jsx)(a.li,{children:"Alguns testes automatizados na camada desktop"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(a.li,{className:"task-list-item",children:[(0,s.jsx)(a.input,{type:"checkbox",checked:!0,disabled:!0})," ","Explorar Design patterns;","\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsx)(a.li,{children:"Hexagonal e MVC"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(a.li,{className:"task-list-item",children:[(0,s.jsx)(a.input,{type:"checkbox",checked:!0,disabled:!0})," ","Implementar padr\xf5es de resili\xeancia na aplica\xe7\xe3o.","\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsx)(a.li,{children:"Cache-Aside: manter os dados em cache para reduzir o n\xfamero de chamadas a api e melhorar o desempenho."}),"\n",(0,s.jsx)(a.li,{children:"Fallback: fornecer uma resposta alternativa ou um comportamento padr\xe3o quando uma opera\xe7\xe3o falha, para minimizar o impacto no usu\xe1rio final."}),"\n",(0,s.jsx)(a.li,{children:"Queue: enfileirar as requisi\xe7\xf5es que n\xe3o podem ser processadas imediatamente, para evitar perda de dados e permitir o processamento posterior."}),"\n"]}),"\n"]}),"\n"]})]})}function u(e={}){const{wrapper:a}={...(0,i.R)(),...e.components};return a?(0,s.jsx)(a,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},28994:(e,a,n)=>{n.d(a,{A:()=>s});const s=n.p+"assets/images/ArquiteturaHexagonal-6692f33db4bce25706d545c8eef7607a.png"},39084:(e,a,n)=>{n.d(a,{A:()=>s});const s=n.p+"assets/images/SequenciaDeBuilds-52b5e718391aca5e86a3cd28e26de5f4.png"},28453:(e,a,n)=>{n.d(a,{R:()=>o,x:()=>c});var s=n(96540);const i={},r=s.createContext(i);function o(e){const a=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function c(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(r.Provider,{value:a},e.children)}}}]);